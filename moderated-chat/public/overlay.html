<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Overlay</title>
  <style>
    body{margin:0;font-family:Arial;background:transparent}
    .msg{font-size:28px;padding:10px;background:rgba(0,0,0,0.6);color:#fff;margin:8px;border-radius:6px}
    #wrap{position:fixed;right:20px;top:20px;max-width:40%;z-index:9999}
  </style>
</head>
<body>
  <div id="wrap"></div>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io({ query: { role: 'overlay' }});
    const wrap = document.getElementById('wrap');

    // load existing approved messages on connect
    socket.emit('fetchApproved');
    socket.on('approvedList', list => {
      wrap.innerHTML = '';
      list.forEach(m => showMsg(m));
    });

    // react to new approvals
    socket.on('approved', m => {
      showMsg(m);
    });

    function showMsg(m) {
      const el = document.createElement('div');
      el.className = 'msg';
      el.innerHTML = `<strong>${m.author}：</strong> ${m.text}`;
      wrap.appendChild(el);
      // optional: auto-hide after N seconds
      setTimeout(()=> {
        el.remove();
      }, 10000); // 10 秒後消失 (可調)
    }
  </script>
</body>
</html>
